<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 8 Data Visualization | Learning R for Mass Spectrometry</title>
  <meta name="description" content="An introductory approach to using R in the analysis of mass spectrometry related data." />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 8 Data Visualization | Learning R for Mass Spectrometry" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="An introductory approach to using R in the analysis of mass spectrometry related data." />
  <meta name="github-repo" content="jeffsocal/ASMS_R_Basics" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 Data Visualization | Learning R for Mass Spectrometry" />
  
  <meta name="twitter:description" content="An introductory approach to using R in the analysis of mass spectrometry related data." />
  

<meta name="author" content="Jeff Jones, Heath Patterson, Ryan Benz" />


<meta name="date" content="2023-06-04" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-wrangling.html"/>
<link rel="next" href="sharing.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.10.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Learning R for Mass Spec.</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="" data-path="acknowledgements.html"><a href="acknowledgements.html"><i class="fa fa-check"></i>Acknowledgements</a></li>
<li class="chapter" data-level="" data-path="contents.html"><a href="contents.html"><i class="fa fa-check"></i>Contents</a></li>
<li class="chapter" data-level="1" data-path="introduction-to-r.html"><a href="introduction-to-r.html"><i class="fa fa-check"></i><b>1</b> Introduction to R</a>
<ul>
<li class="chapter" data-level="" data-path="introduction-to-r.html"><a href="introduction-to-r.html#why-choose-it"><i class="fa fa-check"></i>Why choose it?</a></li>
<li class="chapter" data-level="" data-path="introduction-to-r.html"><a href="introduction-to-r.html#what-you-can-do-with-it"><i class="fa fa-check"></i>What you can do with it?</a></li>
<li class="chapter" data-level="" data-path="introduction-to-r.html"><a href="introduction-to-r.html#the-r-learning-curve"><i class="fa fa-check"></i>The R Learning Curve</a></li>
<li class="chapter" data-level="" data-path="introduction-to-r.html"><a href="introduction-to-r.html#learning-to-code"><i class="fa fa-check"></i>Learning to code</a></li>
<li class="chapter" data-level="1.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#alternatives"><i class="fa fa-check"></i><b>1.1</b> Alternatives</a></li>
<li class="chapter" data-level="1.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#resources"><i class="fa fa-check"></i><b>1.2</b> Resources</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#online"><i class="fa fa-check"></i><b>1.2.1</b> Online</a></li>
<li class="chapter" data-level="1.2.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#in-print"><i class="fa fa-check"></i><b>1.2.2</b> In Print</a></li>
<li class="chapter" data-level="1.2.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#organizations"><i class="fa fa-check"></i><b>1.2.3</b> Organizations</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="installation.html"><a href="installation.html"><i class="fa fa-check"></i><b>2</b> Installation</a>
<ul>
<li class="chapter" data-level="2.1" data-path="installation.html"><a href="installation.html#r-interpreter"><i class="fa fa-check"></i><b>2.1</b> R interpreter</a>
<ul>
<li class="chapter" data-level="" data-path="installation.html"><a href="installation.html#steps"><i class="fa fa-check"></i>Steps</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="installation.html"><a href="installation.html#r-studio-ide"><i class="fa fa-check"></i><b>2.2</b> R Studio IDE</a>
<ul>
<li class="chapter" data-level="" data-path="installation.html"><a href="installation.html#steps-1"><i class="fa fa-check"></i>Steps</a></li>
<li class="chapter" data-level="" data-path="installation.html"><a href="installation.html#ide-layout"><i class="fa fa-check"></i>IDE Layout</a></li>
<li class="chapter" data-level="" data-path="installation.html"><a href="installation.html#usage"><i class="fa fa-check"></i>Usage</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="installation.html"><a href="installation.html#r-packages"><i class="fa fa-check"></i><b>2.3</b> R Packages</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="installation.html"><a href="installation.html#exploring"><i class="fa fa-check"></i><b>2.3.1</b> Exploring</a></li>
<li class="chapter" data-level="2.3.2" data-path="installation.html"><a href="installation.html#installing"><i class="fa fa-check"></i><b>2.3.2</b> Installing</a></li>
<li class="chapter" data-level="" data-path="installation.html"><a href="installation.html#gotchas"><i class="fa fa-check"></i>Gotchas</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="installation.html"><a href="installation.html#for-this-book"><i class="fa fa-check"></i><b>2.4</b> For this Book</a>
<ul>
<li class="chapter" data-level="" data-path="installation.html"><a href="installation.html#tidyverse"><i class="fa fa-check"></i>tidyverse</a></li>
<li class="chapter" data-level="" data-path="installation.html"><a href="installation.html#ms-packages"><i class="fa fa-check"></i>MS Packages</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="r-studio-projects.html"><a href="r-studio-projects.html"><i class="fa fa-check"></i><b>3</b> R Studio Projects</a>
<ul>
<li class="chapter" data-level="3.1" data-path="r-studio-projects.html"><a href="r-studio-projects.html#creating"><i class="fa fa-check"></i><b>3.1</b> Creating</a></li>
<li class="chapter" data-level="3.2" data-path="r-studio-projects.html"><a href="r-studio-projects.html#organizing"><i class="fa fa-check"></i><b>3.2</b> Organizing</a>
<ul>
<li class="chapter" data-level="" data-path="r-studio-projects.html"><a href="r-studio-projects.html#data"><i class="fa fa-check"></i>Data</a></li>
<li class="chapter" data-level="" data-path="r-studio-projects.html"><a href="r-studio-projects.html#scripts"><i class="fa fa-check"></i>Scripts</a></li>
<li class="chapter" data-level="" data-path="r-studio-projects.html"><a href="r-studio-projects.html#results"><i class="fa fa-check"></i>Results</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-studio-projects.html"><a href="r-studio-projects.html#exercises"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="r-syntax.html"><a href="r-syntax.html"><i class="fa fa-check"></i><b>4</b> R Syntax</a>
<ul>
<li class="chapter" data-level="4.1" data-path="r-syntax.html"><a href="r-syntax.html#reserved-words"><i class="fa fa-check"></i><b>4.1</b> Reserved Words</a></li>
<li class="chapter" data-level="4.2" data-path="r-syntax.html"><a href="r-syntax.html#types"><i class="fa fa-check"></i><b>4.2</b> Types</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="r-syntax.html"><a href="r-syntax.html#comments"><i class="fa fa-check"></i><b>4.2.1</b> Comments</a></li>
<li class="chapter" data-level="4.2.2" data-path="r-syntax.html"><a href="r-syntax.html#strings"><i class="fa fa-check"></i><b>4.2.2</b> Strings</a></li>
<li class="chapter" data-level="4.2.3" data-path="r-syntax.html"><a href="r-syntax.html#numbers"><i class="fa fa-check"></i><b>4.2.3</b> Numbers</a></li>
<li class="chapter" data-level="4.2.4" data-path="r-syntax.html"><a href="r-syntax.html#operators"><i class="fa fa-check"></i><b>4.2.4</b> Operators</a></li>
<li class="chapter" data-level="4.2.5" data-path="r-syntax.html"><a href="r-syntax.html#variables"><i class="fa fa-check"></i><b>4.2.5</b> Variables</a></li>
<li class="chapter" data-level="4.2.6" data-path="r-syntax.html"><a href="r-syntax.html#statements"><i class="fa fa-check"></i><b>4.2.6</b> Statements</a></li>
<li class="chapter" data-level="4.2.7" data-path="r-syntax.html"><a href="r-syntax.html#functions"><i class="fa fa-check"></i><b>4.2.7</b> Functions</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="r-syntax.html"><a href="r-syntax.html#flow-control"><i class="fa fa-check"></i><b>4.3</b> Flow-Control</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="r-syntax.html"><a href="r-syntax.html#for-loop"><i class="fa fa-check"></i><b>4.3.1</b> For Loop</a></li>
<li class="chapter" data-level="4.3.2" data-path="r-syntax.html"><a href="r-syntax.html#if-else"><i class="fa fa-check"></i><b>4.3.2</b> If-Else</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="r-syntax.html"><a href="r-syntax.html#exercises-1"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="r-objects.html"><a href="r-objects.html"><i class="fa fa-check"></i><b>5</b> R Objects</a>
<ul>
<li class="chapter" data-level="5.1" data-path="r-objects.html"><a href="r-objects.html#variable"><i class="fa fa-check"></i><b>5.1</b> Variable</a></li>
<li class="chapter" data-level="5.2" data-path="r-objects.html"><a href="r-objects.html#vector"><i class="fa fa-check"></i><b>5.2</b> Vector</a></li>
<li class="chapter" data-level="5.3" data-path="r-objects.html"><a href="r-objects.html#list"><i class="fa fa-check"></i><b>5.3</b> List</a></li>
<li class="chapter" data-level="5.4" data-path="r-objects.html"><a href="r-objects.html#matrix"><i class="fa fa-check"></i><b>5.4</b> Matrix</a></li>
<li class="chapter" data-level="5.5" data-path="r-objects.html"><a href="r-objects.html#data-frame"><i class="fa fa-check"></i><b>5.5</b> Data Frame</a></li>
<li class="chapter" data-level="5.6" data-path="r-objects.html"><a href="r-objects.html#data-table"><i class="fa fa-check"></i><b>5.6</b> Data Table</a></li>
<li class="chapter" data-level="5.7" data-path="r-objects.html"><a href="r-objects.html#tibbles"><i class="fa fa-check"></i><b>5.7</b> Tibbles</a></li>
<li class="chapter" data-level="" data-path="r-objects.html"><a href="r-objects.html#examine-the-contents"><i class="fa fa-check"></i>Examine the Contents</a></li>
<li class="chapter" data-level="" data-path="r-objects.html"><a href="r-objects.html#converting-objects"><i class="fa fa-check"></i>Converting Objects</a></li>
<li class="chapter" data-level="" data-path="r-objects.html"><a href="r-objects.html#exercises-2"><i class="fa fa-check"></i>Exercises</a></li>
<li class="chapter" data-level="" data-path="r-objects.html"><a href="r-objects.html#more-exercises"><i class="fa fa-check"></i>More Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="tidyverse-1.html"><a href="tidyverse-1.html"><i class="fa fa-check"></i><b>6</b> Tidyverse</a>
<ul>
<li class="chapter" data-level="6.1" data-path="tidyverse-1.html"><a href="tidyverse-1.html#core-packages"><i class="fa fa-check"></i><b>6.1</b> Core Packages</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="tidyverse-1.html"><a href="tidyverse-1.html#magrittr"><i class="fa fa-check"></i><b>6.1.1</b> magrittr</a></li>
<li class="chapter" data-level="6.1.2" data-path="tidyverse-1.html"><a href="tidyverse-1.html#tibble"><i class="fa fa-check"></i><b>6.1.2</b> tibble</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="tidyverse-1.html"><a href="tidyverse-1.html#importing"><i class="fa fa-check"></i><b>6.2</b> Importing</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="tidyverse-1.html"><a href="tidyverse-1.html#readr"><i class="fa fa-check"></i><b>6.2.1</b> readr</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="tidyverse-1.html"><a href="tidyverse-1.html#wrangling"><i class="fa fa-check"></i><b>6.3</b> Wrangling</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="tidyverse-1.html"><a href="tidyverse-1.html#dplyr"><i class="fa fa-check"></i><b>6.3.1</b> dplyr</a></li>
<li class="chapter" data-level="6.3.2" data-path="tidyverse-1.html"><a href="tidyverse-1.html#tidyr"><i class="fa fa-check"></i><b>6.3.2</b> tidyr</a></li>
<li class="chapter" data-level="6.3.3" data-path="tidyverse-1.html"><a href="tidyverse-1.html#purrr"><i class="fa fa-check"></i><b>6.3.3</b> purrr</a></li>
<li class="chapter" data-level="6.3.4" data-path="tidyverse-1.html"><a href="tidyverse-1.html#glue"><i class="fa fa-check"></i><b>6.3.4</b> glue</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="tidyverse-1.html"><a href="tidyverse-1.html#data-types"><i class="fa fa-check"></i><b>6.4</b> Data Types</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="tidyverse-1.html"><a href="tidyverse-1.html#stringr"><i class="fa fa-check"></i><b>6.4.1</b> stringr</a></li>
<li class="chapter" data-level="6.4.2" data-path="tidyverse-1.html"><a href="tidyverse-1.html#lubridate"><i class="fa fa-check"></i><b>6.4.2</b> lubridate</a></li>
<li class="chapter" data-level="6.4.3" data-path="tidyverse-1.html"><a href="tidyverse-1.html#forcats"><i class="fa fa-check"></i><b>6.4.3</b> forcats</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="tidyverse-1.html"><a href="tidyverse-1.html#summarizing"><i class="fa fa-check"></i><b>6.5</b> Summarizing</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="tidyverse-1.html"><a href="tidyverse-1.html#dplyr-1"><i class="fa fa-check"></i><b>6.5.1</b> dplyr</a></li>
<li class="chapter" data-level="6.5.2" data-path="tidyverse-1.html"><a href="tidyverse-1.html#ggplot2"><i class="fa fa-check"></i><b>6.5.2</b> ggplot2</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tidyverse-1.html"><a href="tidyverse-1.html#exercises-3"><i class="fa fa-check"></i>Exercises</a></li>
<li class="chapter" data-level="" data-path="tidyverse-1.html"><a href="tidyverse-1.html#more-exercises-1"><i class="fa fa-check"></i>More Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="data-wrangling.html"><a href="data-wrangling.html"><i class="fa fa-check"></i><b>7</b> Data Wrangling</a>
<ul>
<li class="chapter" data-level="7.1" data-path="data-wrangling.html"><a href="data-wrangling.html#tidy-data"><i class="fa fa-check"></i><b>7.1</b> Tidy Data</a></li>
<li class="chapter" data-level="7.2" data-path="data-wrangling.html"><a href="data-wrangling.html#example-walkthrough"><i class="fa fa-check"></i><b>7.2</b> Example Walkthrough</a>
<ul>
<li class="chapter" data-level="" data-path="data-wrangling.html"><a href="data-wrangling.html#read_"><i class="fa fa-check"></i>read_</a></li>
<li class="chapter" data-level="" data-path="data-wrangling.html"><a href="data-wrangling.html#separate"><i class="fa fa-check"></i>separate</a></li>
<li class="chapter" data-level="" data-path="data-wrangling.html"><a href="data-wrangling.html#mutate"><i class="fa fa-check"></i>mutate</a></li>
<li class="chapter" data-level="" data-path="data-wrangling.html"><a href="data-wrangling.html#pivot_"><i class="fa fa-check"></i>pivot_</a></li>
<li class="chapter" data-level="" data-path="data-wrangling.html"><a href="data-wrangling.html#write_"><i class="fa fa-check"></i>write_</a></li>
<li class="chapter" data-level="" data-path="data-wrangling.html"><a href="data-wrangling.html#non-pipe"><i class="fa fa-check"></i>Non-pipe</a></li>
<li class="chapter" data-level="" data-path="data-wrangling.html"><a href="data-wrangling.html#summarize"><i class="fa fa-check"></i>summarize</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="data-wrangling.html"><a href="data-wrangling.html#exercises-4"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="data-visualization.html"><a href="data-visualization.html"><i class="fa fa-check"></i><b>8</b> Data Visualization</a>
<ul>
<li class="chapter" data-level="8.1" data-path="data-visualization.html"><a href="data-visualization.html#base-plot"><i class="fa fa-check"></i><b>8.1</b> Base: plot</a></li>
<li class="chapter" data-level="8.2" data-path="data-visualization.html"><a href="data-visualization.html#ggplot2-1"><i class="fa fa-check"></i><b>8.2</b> GGPlot2</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="data-visualization.html"><a href="data-visualization.html#syntax"><i class="fa fa-check"></i><b>8.2.1</b> Syntax</a></li>
<li class="chapter" data-level="8.2.2" data-path="data-visualization.html"><a href="data-visualization.html#basic-data-plotting"><i class="fa fa-check"></i><b>8.2.2</b> Basic Data Plotting</a></li>
<li class="chapter" data-level="8.2.3" data-path="data-visualization.html"><a href="data-visualization.html#data-distributions"><i class="fa fa-check"></i><b>8.2.3</b> Data Distributions</a></li>
<li class="chapter" data-level="8.2.4" data-path="data-visualization.html"><a href="data-visualization.html#extended-syntax"><i class="fa fa-check"></i><b>8.2.4</b> Extended Syntax</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="data-visualization.html"><a href="data-visualization.html#alternatives-1"><i class="fa fa-check"></i><b>8.3</b> Alternatives</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="data-visualization.html"><a href="data-visualization.html#lattice"><i class="fa fa-check"></i><b>8.3.1</b> lattice</a></li>
<li class="chapter" data-level="8.3.2" data-path="data-visualization.html"><a href="data-visualization.html#plotly"><i class="fa fa-check"></i><b>8.3.2</b> plotly</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="data-visualization.html"><a href="data-visualization.html#exercises-5"><i class="fa fa-check"></i>Exercises</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="sharing.html"><a href="sharing.html"><i class="fa fa-check"></i><b>9</b> Sharing</a>
<ul>
<li class="chapter" data-level="9.1" data-path="sharing.html"><a href="sharing.html#notebooks"><i class="fa fa-check"></i><b>9.1</b> Notebooks</a>
<ul>
<li class="chapter" data-level="" data-path="sharing.html"><a href="sharing.html#creating-1"><i class="fa fa-check"></i>Creating</a></li>
<li class="chapter" data-level="" data-path="sharing.html"><a href="sharing.html#sharing-1"><i class="fa fa-check"></i>Sharing</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="sharing.html"><a href="sharing.html#packrat"><i class="fa fa-check"></i><b>9.2</b> Packrat</a>
<ul>
<li class="chapter" data-level="" data-path="sharing.html"><a href="sharing.html#initiating"><i class="fa fa-check"></i>Initiating</a></li>
<li class="chapter" data-level="" data-path="sharing.html"><a href="sharing.html#installing-1"><i class="fa fa-check"></i>Installing</a></li>
<li class="chapter" data-level="" data-path="sharing.html"><a href="sharing.html#loading"><i class="fa fa-check"></i>Loading</a></li>
<li class="chapter" data-level="" data-path="sharing.html"><a href="sharing.html#updating"><i class="fa fa-check"></i>Updating</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="sharing.html"><a href="sharing.html#github-1"><i class="fa fa-check"></i><b>9.3</b> GitHub</a>
<ul>
<li class="chapter" data-level="" data-path="sharing.html"><a href="sharing.html#sharing-2"><i class="fa fa-check"></i>Sharing</a></li>
<li class="chapter" data-level="" data-path="sharing.html"><a href="sharing.html#sharing-3"><i class="fa fa-check"></i>Sharing</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="sharing.html"><a href="sharing.html#docker"><i class="fa fa-check"></i><b>9.4</b> Docker</a></li>
<li class="chapter" data-level="9.5" data-path="sharing.html"><a href="sharing.html#r-packages-1"><i class="fa fa-check"></i><b>9.5</b> R Packages</a>
<ul>
<li class="chapter" data-level="" data-path="sharing.html"><a href="sharing.html#creating-2"><i class="fa fa-check"></i>Creating</a></li>
<li class="chapter" data-level="" data-path="sharing.html"><a href="sharing.html#using"><i class="fa fa-check"></i>Using</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="sharing.html"><a href="sharing.html#r-shiny-applications"><i class="fa fa-check"></i><b>9.6</b> R Shiny Applications</a>
<ul>
<li class="chapter" data-level="" data-path="sharing.html"><a href="sharing.html#creating-3"><i class="fa fa-check"></i>Creating</a></li>
<li class="chapter" data-level="" data-path="sharing.html"><a href="sharing.html#example"><i class="fa fa-check"></i>Example</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="mass-spectrometry.html"><a href="mass-spectrometry.html"><i class="fa fa-check"></i><b>10</b> Mass Spectrometry</a>
<ul>
<li class="chapter" data-level="10.1" data-path="mass-spectrometry.html"><a href="mass-spectrometry.html#commercial"><i class="fa fa-check"></i><b>10.1</b> Commercial</a>
<ul>
<li class="chapter" data-level="" data-path="mass-spectrometry.html"><a href="mass-spectrometry.html#raw-thermo"><i class="fa fa-check"></i>RAW (Thermo)</a></li>
<li class="chapter" data-level="" data-path="mass-spectrometry.html"><a href="mass-spectrometry.html#d-bruker-timstof-data"><i class="fa fa-check"></i>.d (Bruker) timsTOF data</a></li>
<li class="chapter" data-level="" data-path="mass-spectrometry.html"><a href="mass-spectrometry.html#wiff-sciex"><i class="fa fa-check"></i>WIFF (Sciex)</a></li>
<li class="chapter" data-level="" data-path="mass-spectrometry.html"><a href="mass-spectrometry.html#d-agilent"><i class="fa fa-check"></i>D (Agilent)</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="mass-spectrometry.html"><a href="mass-spectrometry.html#open-access-data"><i class="fa fa-check"></i><b>10.2</b> Open Access Data</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="mass-spectrometry.html"><a href="mass-spectrometry.html#proteowizard"><i class="fa fa-check"></i><b>10.2.1</b> ProteoWizard</a></li>
<li class="chapter" data-level="10.2.2" data-path="mass-spectrometry.html"><a href="mass-spectrometry.html#mzxml"><i class="fa fa-check"></i><b>10.2.2</b> mzXML</a></li>
<li class="chapter" data-level="10.2.3" data-path="mass-spectrometry.html"><a href="mass-spectrometry.html#mzml"><i class="fa fa-check"></i><b>10.2.3</b> mzML</a></li>
<li class="chapter" data-level="10.2.4" data-path="mass-spectrometry.html"><a href="mass-spectrometry.html#mzmlb"><i class="fa fa-check"></i><b>10.2.4</b> mzMLb</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="mass-spectrometry.html"><a href="mass-spectrometry.html#r-mass"><i class="fa fa-check"></i><b>10.3</b> R Mass</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="mass-spectrometry.html"><a href="mass-spectrometry.html#brain"><i class="fa fa-check"></i><b>10.3.1</b> BRAIN</a></li>
<li class="chapter" data-level="10.3.2" data-path="mass-spectrometry.html"><a href="mass-spectrometry.html#envipat"><i class="fa fa-check"></i><b>10.3.2</b> enviPat</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="mass-spectrometry.html"><a href="mass-spectrometry.html#r-ms-data"><i class="fa fa-check"></i><b>10.4</b> R MS Data</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="mass-spectrometry.html"><a href="mass-spectrometry.html#rformassspectrometry"><i class="fa fa-check"></i><b>10.4.1</b> RforMassSpectrometry</a></li>
<li class="chapter" data-level="10.4.2" data-path="mass-spectrometry.html"><a href="mass-spectrometry.html#msnbase"><i class="fa fa-check"></i><b>10.4.2</b> MSnbase</a></li>
<li class="chapter" data-level="10.4.3" data-path="mass-spectrometry.html"><a href="mass-spectrometry.html#mzr"><i class="fa fa-check"></i><b>10.4.3</b> mzR</a></li>
<li class="chapter" data-level="10.4.4" data-path="mass-spectrometry.html"><a href="mass-spectrometry.html#xcms"><i class="fa fa-check"></i><b>10.4.4</b> xcms</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="mass-spectrometry.html"><a href="mass-spectrometry.html#r-ms-analysis"><i class="fa fa-check"></i><b>10.5</b> R MS Analysis</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="mass-spectrometry.html"><a href="mass-spectrometry.html#msstats"><i class="fa fa-check"></i><b>10.5.1</b> MSstats</a></li>
<li class="chapter" data-level="10.5.2" data-path="mass-spectrometry.html"><a href="mass-spectrometry.html#tidyproteomics"><i class="fa fa-check"></i><b>10.5.2</b> Tidyproteomics</a></li>
<li class="chapter" data-level="10.5.3" data-path="mass-spectrometry.html"><a href="mass-spectrometry.html#assayr"><i class="fa fa-check"></i><b>10.5.3</b> AssayR</a></li>
<li class="chapter" data-level="10.5.4" data-path="mass-spectrometry.html"><a href="mass-spectrometry.html#deqms"><i class="fa fa-check"></i><b>10.5.4</b> DEqMS</a></li>
<li class="chapter" data-level="10.5.5" data-path="mass-spectrometry.html"><a href="mass-spectrometry.html#ms-empire"><i class="fa fa-check"></i><b>10.5.5</b> MS-EmpiRe</a></li>
<li class="chapter" data-level="10.5.6" data-path="mass-spectrometry.html"><a href="mass-spectrometry.html#msgrob2"><i class="fa fa-check"></i><b>10.5.6</b> msgrob2</a></li>
<li class="chapter" data-level="10.5.7" data-path="mass-spectrometry.html"><a href="mass-spectrometry.html#statspro"><i class="fa fa-check"></i><b>10.5.7</b> StatsPro</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="answers-to-exercises.html"><a href="answers-to-exercises.html"><i class="fa fa-check"></i>Answers to Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="answers-to-exercises.html"><a href="answers-to-exercises.html#r-syntax-1"><i class="fa fa-check"></i><strong>4</strong> R Syntax</a></li>
<li class="chapter" data-level="" data-path="answers-to-exercises.html"><a href="answers-to-exercises.html#r-objects-1"><i class="fa fa-check"></i><strong>5</strong> R Objects</a></li>
<li class="chapter" data-level="" data-path="answers-to-exercises.html"><a href="answers-to-exercises.html#tidyverse-2"><i class="fa fa-check"></i><strong>6</strong> Tidyverse</a></li>
<li class="chapter" data-level="" data-path="answers-to-exercises.html"><a href="answers-to-exercises.html#data-wrangling-1"><i class="fa fa-check"></i><strong>7</strong> Data Wrangling</a></li>
<li class="chapter" data-level="" data-path="answers-to-exercises.html"><a href="answers-to-exercises.html#data-visualization-1"><i class="fa fa-check"></i><strong>8</strong> Data Visualization</a></li>
<li class="chapter" data-level="" data-path="answers-to-exercises.html"><a href="answers-to-exercises.html#more-5-r-objects"><i class="fa fa-check"></i>More <strong>5</strong> R Objects</a></li>
<li class="chapter" data-level="" data-path="answers-to-exercises.html"><a href="answers-to-exercises.html#more-6-tidyverse"><i class="fa fa-check"></i>More <strong>6</strong> Tidyverse</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/jeffsocal/asms_r_intro" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Learning R for Mass Spectrometry</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-visualization" class="section level1 hasAnchor" number="8">
<h1><span class="header-section-number">Chapter 8</span> Data Visualization<a href="data-visualization.html#data-visualization" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Visualizing your data is crucial because it helps you understand the patterns, trends, and relationships within the data. A well-designed visualization can make complex data easy to understand and convey insights that would be hard to discern from raw data.</p>
<p>Anscombe’s quartet is a classic example that demonstrates the importance of visualizing your data. This quartet comprises four datasets with nearly identical simple descriptive statistics. However, when graphed, they have very different distributions and appear very different from one another. This example shows that relying solely on summary statistics to understand data can be misleading and inadequate.</p>
<table>
<caption><span id="tab:unnamed-chunk-180">Table 8.1: </span>Summary stats for Anscombe’s quartet.</caption>
<colgroup>
<col width="6%" />
<col width="10%" />
<col width="9%" />
<col width="13%" />
<col width="13%" />
<col width="15%" />
<col width="15%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">set</th>
<th align="right">mean_x</th>
<th align="right">var_x</th>
<th align="right">mean_y</th>
<th align="right">var_y</th>
<th align="right">intercept</th>
<th align="right">slope</th>
<th align="right">r.squared</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">A</td>
<td align="right">9</td>
<td align="right">11</td>
<td align="right">7.500909</td>
<td align="right">4.127269</td>
<td align="right">3.000091</td>
<td align="right">0.5000909</td>
<td align="right">0.6665425</td>
</tr>
<tr class="even">
<td align="left">B</td>
<td align="right">9</td>
<td align="right">11</td>
<td align="right">7.500909</td>
<td align="right">4.127629</td>
<td align="right">3.000909</td>
<td align="right">0.5000000</td>
<td align="right">0.6662420</td>
</tr>
<tr class="odd">
<td align="left">C</td>
<td align="right">9</td>
<td align="right">11</td>
<td align="right">7.500000</td>
<td align="right">4.122620</td>
<td align="right">3.002454</td>
<td align="right">0.4997273</td>
<td align="right">0.6663240</td>
</tr>
<tr class="even">
<td align="left">D</td>
<td align="right">9</td>
<td align="right">11</td>
<td align="right">7.500000</td>
<td align="right">4.126740</td>
<td align="right">3.000000</td>
<td align="right">0.5000000</td>
<td align="right">0.6663856</td>
</tr>
</tbody>
</table>
<p><img src="_main_files/figure-html/unnamed-chunk-181-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>In data analysis, creating a plot to convey a message or demonstrate a result is a common endpoint. To achieve this, this book utilizes the <code>GGPlot2</code> package, which is part of the <code>Tidyverse</code>. This package complements the data pipelining demonstrated in the previous chapters, making it a perfect choice for creating a wide range of plots, from simple scatter plots to complex heat maps, making it ideal for data visualization.</p>
<p><br />
</p>
<table>
<colgroup>
<col width="36%" />
<col width="63%" />
</colgroup>
<tbody>
<tr class="odd">
<td><img src="images/03.png" height="68" /></td>
<td><p><strong>At the end of this chapter you should be able to</strong></p>
<ul>
<li><p>Understand the need for visualizations.</p></li>
<li><p>Create some simple plots of points, lines and bars.</p></li>
<li><p>Manipulate how a plot looks.</p></li>
</ul></td>
</tr>
</tbody>
</table>
<p><br />
</p>
<div id="base-plot" class="section level2 hasAnchor" number="8.1">
<h2><span class="header-section-number">8.1</span> Base: plot<a href="data-visualization.html#base-plot" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>R comes standard with the fairly basic plotting function <code>plot()</code>. While this function forms the basis for all plotting interactions in R, it can be greatly extended with additional packages. Three such packages widely used are <code>lattice</code>, <code>GGplot2</code>, <code>Plotly</code>. This chapter will dive into <code>GGplot2</code> which is integrated with the tidyverse, and is great for static publication quality plots. The other two will briefly be covered as suitable alternatives.</p>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="data-visualization.html#cb246-1" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>),<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-182-1.png" width="384" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="data-visualization.html#cb247-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>( <span class="at">x1 =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>), <span class="at">y1 =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>) )</span>
<span id="cb247-2"><a href="data-visualization.html#cb247-2" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">plot</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-183-1.png" width="384" style="display: block; margin: auto;" /></p>

<!--# JEFF -->
</div>
<div id="ggplot2-1" class="section level2 hasAnchor" number="8.2">
<h2><span class="header-section-number">8.2</span> GGPlot2<a href="data-visualization.html#ggplot2-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The motivation behind GGplot is based on the grammar of graphics such that</p>
<blockquote>
<p><em>“the idea that you can build every graph from the same few components”</em></p>
</blockquote>
<p>Ideally this accomplishes dual goals of allowing you to quickly construct plots for initial analyses and checking for oddities (as explained above) and following the logical process of the plot construction.</p>
<div id="syntax" class="section level3 hasAnchor" number="8.2.1">
<h3><span class="header-section-number">8.2.1</span> Syntax<a href="data-visualization.html#syntax" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To graph in GGPlot there are a few core embodiments that need to be considered.</p>
<p><br />
</p>
<table style="width:99%;">
<colgroup>
<col width="11%" />
<col width="58%" />
<col width="29%" />
</colgroup>
<tbody>
<tr class="odd">
<td>data
geom
aesthetics
coordinate</td>
<td>a table of numeric and/or categorical values
a geometric object or visual representation, that can be layered
how variables in the data are mapped to visual properties
orientation of the data points</td>
<td>data.frame or tibble
points, lines, bars, boxs, etc.
eg. <em>x = col_a, y = col_b</em>
eg. <em>cartesian (x,y), polar</em></td>
</tr>
</tbody>
</table>
<p><br />
</p>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="data-visualization.html#cb248-1" tabindex="-1"></a><span class="co"># the basic structure</span></span>
<span id="cb248-2"><a href="data-visualization.html#cb248-2" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(x,y)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">coord_cartiesian</span>()</span>
<span id="cb248-3"><a href="data-visualization.html#cb248-3" tabindex="-1"></a></span>
<span id="cb248-4"><a href="data-visualization.html#cb248-4" tabindex="-1"></a><span class="co"># combined with dplyr makes for a readable process</span></span>
<span id="cb248-5"><a href="data-visualization.html#cb248-5" tabindex="-1"></a>data <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(x,y)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code></pre></div>
<p>In this example the <code>ggplot()</code> function contains the two components, the data table <code>data</code> and mapping function <code>aes()</code>. Since <em>GGPlot</em> follows a layered modality, the <code>ggplot()</code> function “sets” the canvas and passes the data table <code>data</code> and mapping function <code>aes()</code> to all the functions that follow with the <code>+</code> operator.</p>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="data-visualization.html#cb249-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<p>Lets create some data …</p>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="data-visualization.html#cb250-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">5</span>)</span>
<span id="cb250-2"><a href="data-visualization.html#cb250-2" tabindex="-1"></a>n_peaks <span class="ot">&lt;-</span> <span class="dv">300</span></span>
<span id="cb250-3"><a href="data-visualization.html#cb250-3" tabindex="-1"></a>tbl_mz <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb250-4"><a href="data-visualization.html#cb250-4" tabindex="-1"></a>  <span class="at">mz =</span> <span class="fu">sample</span>(<span class="dv">3500</span><span class="sc">:</span><span class="dv">20000</span><span class="sc">/</span><span class="dv">10</span>, n_peaks),</span>
<span id="cb250-5"><a href="data-visualization.html#cb250-5" tabindex="-1"></a>  <span class="at">int =</span> <span class="fu">rlnorm</span>(<span class="at">meanlog =</span> <span class="dv">5</span>, <span class="at">sdlog =</span> <span class="dv">2</span>, n_peaks),</span>
<span id="cb250-6"><a href="data-visualization.html#cb250-6" tabindex="-1"></a>  <span class="at">class =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">&#39;A&#39;</span>,<span class="st">&#39;B&#39;</span>,<span class="st">&#39;C&#39;</span>,<span class="st">&#39;D&#39;</span>), n_peaks, <span class="at">replace =</span> <span class="cn">TRUE</span>) </span>
<span id="cb250-7"><a href="data-visualization.html#cb250-7" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="basic-data-plotting" class="section level3 hasAnchor" number="8.2.2">
<h3><span class="header-section-number">8.2.2</span> Basic Data Plotting<a href="data-visualization.html#basic-data-plotting" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><br />
</p>
<table>
<colgroup>
<col width="45%" />
<col width="54%" />
</colgroup>
<tbody>
<tr class="odd">
<td><img src="images/01.png" height="68" /></td>
<td><a href="introduction-to-r.html#online">1.2.1</a> <strong>Online Cheat-sheets</strong></td>
</tr>
</tbody>
</table>
<p><br />
</p>
<div id="points-and-lines" class="section level4 unnumbered hasAnchor">
<h4>Points and Lines<a href="data-visualization.html#points-and-lines" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Points and lines graphing is a simple way of representing data in a two-dimensional space. In this graph, we use points to represent individual data values, and lines to connect them. The x-axis usually represents the <strong>independent</strong> variable while the y-axis represents the <strong>dependent</strong> variable - or in other words, what <em>y</em> was observed while measuring <em>x</em>.</p>
<p>To plot a point, we use an ordered pair of values (x, y) that correspond to the position of the point on the graph. For example, the point (2, 5) would be plotted 2 units to the right on the x-axis and 5 units up on the y-axis.</p>
<p>We can also connect points with lines to show a trend or pattern in the data. These lines can be straight or curved, depending on the nature of the data. A straight line can be drawn to connect two points or to represent a linear relationship between the variables.</p>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="data-visualization.html#cb251-1" tabindex="-1"></a>p01 <span class="ot">&lt;-</span> tbl_mz <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(mz, int)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span>
<span id="cb251-2"><a href="data-visualization.html#cb251-2" tabindex="-1"></a>p02 <span class="ot">&lt;-</span> tbl_mz <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(mz, int)) <span class="sc">+</span> <span class="fu">geom_line</span>()</span>
<span id="cb251-3"><a href="data-visualization.html#cb251-3" tabindex="-1"></a>p03 <span class="ot">&lt;-</span> tbl_mz <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(mz, int)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">&#39;red&#39;</span>) <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="at">color=</span><span class="st">&#39;black&#39;</span>)</span>
<span id="cb251-4"><a href="data-visualization.html#cb251-4" tabindex="-1"></a>p04 <span class="ot">&lt;-</span> tbl_mz <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(mz, int)) <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="at">color=</span><span class="st">&#39;black&#39;</span>) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">&#39;red&#39;</span>)</span></code></pre></div>
<p>It’s important to take note of the difference between plots <em>p03</em> and <em>p04</em>. While both plots showcase a similar data representation, a closer look reveals a notable difference. Specifically, in the latter plot (<em>p04</em>), we can see that the red points appear under the black line. This occurs because the points were layered first, and then the lines were layered over them. This is a crucial distinction to make as it highlights the importance of the order in which layers are applied in the plot.
<img src="_main_files/figure-html/unnamed-chunk-189-1.png" width="768" style="display: block; margin: auto;" /></p>
</div>
<div id="segments" class="section level4 unnumbered hasAnchor">
<h4>Segments<a href="data-visualization.html#segments" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Line segments are an important concept in geometry and are used in various applications. A line segment is a part of a line that is bounded by two distinct end points. It is also a default representation of centroided mass spectra. In this case the segment will start and end on the same <em>x</em> (mz), while the <em>y</em> (int) component will end at 0.</p>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="data-visualization.html#cb252-1" tabindex="-1"></a>p05 <span class="ot">&lt;-</span> tbl_mz <span class="sc">%&gt;%</span> </span>
<span id="cb252-2"><a href="data-visualization.html#cb252-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(mz, int)) <span class="sc">+</span> </span>
<span id="cb252-3"><a href="data-visualization.html#cb252-3" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">xend =</span> mz, <span class="at">yend =</span> <span class="dv">0</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-191-1.png" width="384" style="display: block; margin: auto;" /></p>
</div>
<div id="bar-chart" class="section level4 unnumbered hasAnchor">
<h4>Bar Chart<a href="data-visualization.html#bar-chart" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>When it comes to representing categorical data, bar charts are considered to be the most effective visualization tool. Bar charts are simple, yet powerful, and can be used to display data in a clear and concise way. They are easy to read and understand, and are a popular choice among data analysts, researchers, and business professionals. Whether you’re trying to visualize sales data, survey results, or demographic information, bar charts are a great option to consider. So, if you’re looking for a way to represent categorical data, consider using a bar chart for the most accurate and comprehensive representation.</p>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="data-visualization.html#cb253-1" tabindex="-1"></a>p06 <span class="ot">&lt;-</span> tbl_mz <span class="sc">%&gt;%</span> </span>
<span id="cb253-2"><a href="data-visualization.html#cb253-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(class)) <span class="sc">+</span> </span>
<span id="cb253-3"><a href="data-visualization.html#cb253-3" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-193-1.png" width="384" style="display: block; margin: auto;" /></p>
</div>
<div id="pie-chart" class="section level4 unnumbered hasAnchor">
<h4>Pie Chart<a href="data-visualization.html#pie-chart" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>You maybe considering a pie chart, which is a circular diagram divided into sectors, with each sector representing a proportion of the whole. It is commonly used to display percentages, where the sum of the sectors equals 100%. There is no specific <code>geom</code> to build a pie-chart with ggplot2. The trick is to build a barplot and use <code>coord_polar()</code> to make it circular. However, interpreting pie charts can be challenging since humans are not very skilled at reading angles. For instance, it is often difficult to determine which group is the largest and to arrange them by value. As a result, it is advisable to refrain from using pie charts.</p>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="data-visualization.html#cb254-1" tabindex="-1"></a>p07 <span class="ot">&lt;-</span> tbl_mz <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(class, <span class="at">fill=</span>class)) <span class="sc">+</span> <span class="fu">geom_bar</span>()</span>
<span id="cb254-2"><a href="data-visualization.html#cb254-2" tabindex="-1"></a>p08 <span class="ot">&lt;-</span> tbl_mz <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(class, <span class="at">fill=</span>class)) <span class="sc">+</span> <span class="fu">geom_bar</span>() <span class="sc">+</span> <span class="fu">coord_flip</span>()</span>
<span id="cb254-3"><a href="data-visualization.html#cb254-3" tabindex="-1"></a>p09 <span class="ot">&lt;-</span> tbl_mz <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="dv">1</span>, <span class="at">fill=</span>class)) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">&#39;fill&#39;</span>) <span class="sc">+</span> <span class="fu">coord_polar</span>(<span class="at">theta =</span> <span class="st">&#39;y&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-195-1.png" width="768" style="display: block; margin: auto;" />
Note how difficult it is in the pie chart to tell (by eye) which is the smallest.</p>
</div>
</div>
<div id="data-distributions" class="section level3 hasAnchor" number="8.2.3">
<h3><span class="header-section-number">8.2.3</span> Data Distributions<a href="data-visualization.html#data-distributions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In statistics, a distribution refers to the way in which a set of data is spread out or dispersed. It describes the pattern of values that a variable can take and how frequently each value occurs. A distribution can be characterized by its shape, center, and spread, and can be represented graphically using tools such as histograms, box plots, and density plots.</p>
<div id="histograms" class="section level4 unnumbered hasAnchor">
<h4>Histograms<a href="data-visualization.html#histograms" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>A histogram is a graphical representation of the distribution of a dataset. It is a type of bar chart that displays the frequency of data values falling into specified intervals or ranges of values, known as bins. The x-axis of the histogram represents the bins or intervals, and the y-axis represents the frequency or count of values falling into each bin.</p>
<p>Histograms are widely used to summarize large datasets and identify patterns or trends and to visualize the shape of a distribution, whether it is symmetric or skewed, and whether it has any outliers or gaps in the data. They can also be used to compare the distributions of two or more datasets, by plotting them on the same graph with different colors or patterns.</p>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="data-visualization.html#cb255-1" tabindex="-1"></a>p10 <span class="ot">&lt;-</span> tbl_mz <span class="sc">%&gt;%</span> </span>
<span id="cb255-2"><a href="data-visualization.html#cb255-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="fu">log10</span>(int))) <span class="sc">+</span> </span>
<span id="cb255-3"><a href="data-visualization.html#cb255-3" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-197-1.png" width="384" style="display: block; margin: auto;" /></p>
</div>
<div id="density" class="section level4 unnumbered hasAnchor">
<h4>Density<a href="data-visualization.html#density" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>A density plot is a graphical representation of the distribution of a dataset. It is formed by smoothing the data values and representing them as a continuous probability density function. The density plot is a variation of the histogram that provides a smoother representation of the data, eliminating the need for binning. It is particularly useful when the data is continuous and the sample size is large. The density plot can be used to identify the shape of the distribution, the presence of multiple modes, and the presence of outliers. Again, it can also be used to compare the distributions of two or more datasets by overlaying them on the same plot.</p>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="data-visualization.html#cb256-1" tabindex="-1"></a>p11 <span class="ot">&lt;-</span> tbl_mz <span class="sc">%&gt;%</span> </span>
<span id="cb256-2"><a href="data-visualization.html#cb256-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="fu">log10</span>(int))) <span class="sc">+</span> </span>
<span id="cb256-3"><a href="data-visualization.html#cb256-3" tabindex="-1"></a>  <span class="fu">geom_density</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-199-1.png" width="384" style="display: block; margin: auto;" /></p>
</div>
<div id="box-plot" class="section level4 unnumbered hasAnchor">
<h4>Box-Plot<a href="data-visualization.html#box-plot" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>One of the most commonly used types of plots in GGplot2 is the box plot. A box plot is used to display the distribution of a continuous variable. It shows the median, interquartile range, and any outliers present in the data.</p>
<p>Box plots are useful in scientific analysis because they allow us to quickly see the distribution of a variable and identify any potential outliers. They are particularly useful when comparing the distribution of a variable across different groups or categories. For example, we may use a box plot to compare the distribution of values across different class levels.</p>
<p>To create a box plot in GGplot2, we use the <code>geom_boxplot()</code> function. We specify the variable we want to plot on the y-axis and any grouping variables on the x-axis.</p>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="data-visualization.html#cb257-1" tabindex="-1"></a>p12 <span class="ot">&lt;-</span> tbl_mz <span class="sc">%&gt;%</span> </span>
<span id="cb257-2"><a href="data-visualization.html#cb257-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(class, <span class="fu">log10</span>(int))) <span class="sc">+</span> </span>
<span id="cb257-3"><a href="data-visualization.html#cb257-3" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-201-1.png" width="384" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="extended-syntax" class="section level3 hasAnchor" number="8.2.4">
<h3><span class="header-section-number">8.2.4</span> Extended Syntax<a href="data-visualization.html#extended-syntax" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>One way to enhance the functionality of ggplots is by using additional modifiers. These modifiers can help you to create more intricate and detailed visualizations that better represent your data. By tweaking the parameters of your ggplots, you can create visualizations that are more informative, aesthetically pleasing, and tailored to your specific needs. Whether you want to adjust the color scheme, add annotations, or modify the axis labels, additional modifiers can help you to achieve your desired outcome.</p>
<div id="colors" class="section level4 unnumbered hasAnchor">
<h4>Colors<a href="data-visualization.html#colors" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We saw a bit how to adjust colors in the previous plots. The two color arguments to consider are <code>color</code>, which modifies the point, line and edge color, and <code>fill</code>, which modifies the internal color of a shape for plots such as <code>geom_bar</code> and <code>geom_histogram</code>.</p>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="data-visualization.html#cb258-1" tabindex="-1"></a>p13 <span class="ot">&lt;-</span> tbl_mz <span class="sc">%&gt;%</span> </span>
<span id="cb258-2"><a href="data-visualization.html#cb258-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="fu">log10</span>(int))) <span class="sc">+</span> </span>
<span id="cb258-3"><a href="data-visualization.html#cb258-3" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">color =</span> <span class="st">&#39;blue&#39;</span>, <span class="at">fill =</span> <span class="st">&#39;purple&#39;</span>, <span class="at">binwidth =</span> <span class="dv">1</span>)</span>
<span id="cb258-4"><a href="data-visualization.html#cb258-4" tabindex="-1"></a></span>
<span id="cb258-5"><a href="data-visualization.html#cb258-5" tabindex="-1"></a>p14 <span class="ot">&lt;-</span> tbl_mz <span class="sc">%&gt;%</span> </span>
<span id="cb258-6"><a href="data-visualization.html#cb258-6" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="fu">log10</span>(int))) <span class="sc">+</span> </span>
<span id="cb258-7"><a href="data-visualization.html#cb258-7" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color =</span> <span class="st">&#39;red&#39;</span>, <span class="at">fill =</span> <span class="st">&#39;orange&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-203-1.png" width="768" style="display: block; margin: auto;" />
Colors can also take on a transparency called <code>alpha</code>, which allows one layer to show through when two or more are plotted together.</p>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="data-visualization.html#cb259-1" tabindex="-1"></a>p15 <span class="ot">&lt;-</span> tbl_mz <span class="sc">%&gt;%</span> </span>
<span id="cb259-2"><a href="data-visualization.html#cb259-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="fu">log10</span>(int))) <span class="sc">+</span> </span>
<span id="cb259-3"><a href="data-visualization.html#cb259-3" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">fill =</span> class))</span>
<span id="cb259-4"><a href="data-visualization.html#cb259-4" tabindex="-1"></a></span>
<span id="cb259-5"><a href="data-visualization.html#cb259-5" tabindex="-1"></a>p16 <span class="ot">&lt;-</span> tbl_mz <span class="sc">%&gt;%</span> </span>
<span id="cb259-6"><a href="data-visualization.html#cb259-6" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="fu">log10</span>(int))) <span class="sc">+</span> </span>
<span id="cb259-7"><a href="data-visualization.html#cb259-7" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">fill =</span> class), <span class="at">alpha =</span> .<span class="dv">25</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-205-1.png" width="768" style="display: block; margin: auto;" /></p>
</div>
<div id="scales" class="section level4 unnumbered hasAnchor">
<h4>Scales<a href="data-visualization.html#scales" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>GGplot2 is a popular data visualization package in R that allows users to create stunning and insightful visualizations. One of the key features of GGplot2 is its ability to handle scales, which are critical for displaying data accurately and effectively. In this document, we will explore how to use scales in GGplot2, specifically for log10 and manual scales.</p>
<div id="log10-scale" class="section level5 unnumbered hasAnchor">
<h5>Log10 Scale<a href="data-visualization.html#log10-scale" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Logarithmic scales are useful when the data spans several orders of magnitude. GGplot2 makes it easy to create log10 scales using the <code>scale_y_log10()</code> and <code>scale_x_log10()</code> functions.</p>
<p>Using the same examples from above, yet instead of applying the <code>log10()</code> function directly to the variable, we can apply it to the scale instead.</p>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="data-visualization.html#cb260-1" tabindex="-1"></a>p17 <span class="ot">&lt;-</span> tbl_mz <span class="sc">%&gt;%</span> </span>
<span id="cb260-2"><a href="data-visualization.html#cb260-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(int)) <span class="sc">+</span> </span>
<span id="cb260-3"><a href="data-visualization.html#cb260-3" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">fill =</span> class), <span class="at">position =</span> <span class="st">&#39;identity&#39;</span>, <span class="at">alpha =</span> .<span class="dv">5</span>, <span class="at">binwidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb260-4"><a href="data-visualization.html#cb260-4" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>()</span>
<span id="cb260-5"><a href="data-visualization.html#cb260-5" tabindex="-1"></a></span>
<span id="cb260-6"><a href="data-visualization.html#cb260-6" tabindex="-1"></a>p18 <span class="ot">&lt;-</span> tbl_mz <span class="sc">%&gt;%</span> </span>
<span id="cb260-7"><a href="data-visualization.html#cb260-7" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(int)) <span class="sc">+</span> </span>
<span id="cb260-8"><a href="data-visualization.html#cb260-8" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">fill =</span> class), <span class="at">alpha =</span> .<span class="dv">25</span>) <span class="sc">+</span></span>
<span id="cb260-9"><a href="data-visualization.html#cb260-9" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-207-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>This results in a plot where the y-axis is scaled logarithmically, making it easier to see the differences between the different car classes. Note, that when we specified the <code>binwidth = 1</code> in the <code>geom_histogram()</code>, GGplot2 applied that to the log10 space specified from the <code>scale_x_log10()</code>.</p>
</div>
<div id="manual-scales" class="section level5 unnumbered hasAnchor">
<h5>Manual Scales<a href="data-visualization.html#manual-scales" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Sometimes, we may want to manually define the scale for our plots. For example, we may want to create a plot where the y-axis only shows values between 0 and 10. We can do this using the <code>scale_y_continuous()</code> function in GGplot2.</p>
<p>Here is an example of how to use the <code>scale_y_continuous()</code> function to manually define the y-axis scale:</p>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="data-visualization.html#cb261-1" tabindex="-1"></a>p19 <span class="ot">&lt;-</span> tbl_mz <span class="sc">%&gt;%</span> </span>
<span id="cb261-2"><a href="data-visualization.html#cb261-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(mz, int)) <span class="sc">+</span> </span>
<span id="cb261-3"><a href="data-visualization.html#cb261-3" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">xend =</span> mz, <span class="at">yend =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb261-4"><a href="data-visualization.html#cb261-4" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">n.breaks =</span> <span class="dv">13</span>) <span class="sc">+</span></span>
<span id="cb261-5"><a href="data-visualization.html#cb261-5" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">n.breaks =</span> <span class="dv">5</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-209-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>In this example, we added a manual scale to both the x- and y-axis using the <code>scale_x_continuous()</code> and <code>scale_y_continuous()</code> functions, respectively, and specifying the number of breaks <code>n.breaks =</code> and the limits <code>limits =</code>.</p>
</div>
<div id="faceting" class="section level5 unnumbered hasAnchor">
<h5>Faceting<a href="data-visualization.html#faceting" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Faceting is a powerful feature in ggplot2 that allows us to split a single plot into multiple small plots based on a categorical variable. It enables us to visualize complex data patterns and relationships in a more understandable way. There are two types of faceting in ggplot2: facet_wrap and facet_grid.</p>
<div id="facet_wrap" class="section level6 unnumbered hasAnchor">
<h6>facet_wrap<a href="data-visualization.html#facet_wrap" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<p><code>facet_wrap</code> creates a grid of plots by wrapping the facets from left-to-right and top-to-bottom in the plot. Each facet is displayed in a separate panel, and the panels are arranged in rows and columns based on the levels of the specified categorical variable.</p>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="data-visualization.html#cb262-1" tabindex="-1"></a>p20 <span class="ot">&lt;-</span> p17 <span class="sc">+</span> <span class="fu">facet_wrap</span>(. <span class="sc">~</span> class)</span>
<span id="cb262-2"><a href="data-visualization.html#cb262-2" tabindex="-1"></a></span>
<span id="cb262-3"><a href="data-visualization.html#cb262-3" tabindex="-1"></a>p21 <span class="ot">&lt;-</span> p17 <span class="sc">+</span> <span class="fu">facet_wrap</span>(. <span class="sc">~</span> class, <span class="at">scales =</span> <span class="st">&#39;free&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-211-1.png" width="768" style="display: block; margin: auto;" />
In this example, we are reused ggplot object <code>p17</code> and created two additional plots. The <code>facet_wrap</code> function is used to split the plot into multiple panels based on the categorical variable <code>class</code> using the tilde <code>. ~ class</code>. In this case, the dot <code>.</code> prior to the tilde <code>~</code> tells ggplot to consider only a single variable, <code>class</code> as we had defined it. You can think of the tilde as a type of function <code>this 'by' that</code> or <code>y ~ x</code>. This becomes more important in the <code>facet_grid()</code> function. Notice in the <code>p21</code> plot we set the scales <code>free</code>, allowing each facet to dictate <code>x</code> and <code>y</code> plot scales.</p>
</div>
<div id="facet_grid" class="section level6 unnumbered hasAnchor">
<h6>facet_grid<a href="data-visualization.html#facet_grid" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<p><code>facet_grid</code> creates a grid of plots by specifying one or more categorical variables that define the rows and columns of the grid. It allows us to create more complex faceted plots than <code>facet_wrap</code>. In this example we will randomly add a new varaible called <code>group</code> that will allow us to create the <code>y</code> direction of the facet.</p>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="data-visualization.html#cb263-1" tabindex="-1"></a>tbl_new <span class="ot">&lt;-</span> tbl_mz <span class="sc">%&gt;%</span></span>
<span id="cb263-2"><a href="data-visualization.html#cb263-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">&#39;positive&#39;</span>, <span class="st">&#39;negative&#39;</span>), n_peaks, <span class="at">replace =</span> <span class="cn">TRUE</span>))</span>
<span id="cb263-3"><a href="data-visualization.html#cb263-3" tabindex="-1"></a></span>
<span id="cb263-4"><a href="data-visualization.html#cb263-4" tabindex="-1"></a>p22 <span class="ot">&lt;-</span> tbl_new <span class="sc">%&gt;%</span> </span>
<span id="cb263-5"><a href="data-visualization.html#cb263-5" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(int)) <span class="sc">+</span> </span>
<span id="cb263-6"><a href="data-visualization.html#cb263-6" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb263-7"><a href="data-visualization.html#cb263-7" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb263-8"><a href="data-visualization.html#cb263-8" tabindex="-1"></a>  <span class="fu">facet_grid</span>(group <span class="sc">~</span> class)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-213-1.png" width="768" style="display: block; margin: auto;" />
To illistrate the difference between <code>facet_wrap()</code> and <code>facet_grid()</code> consider what happens when a set of data is missing. Note in <code>p24</code> it is not immediately intuitive in <code>facet_wrap()</code> that <code>c-negative</code> is missing, where as in <code>facet_grid()</code>, the layout highlights this realization.</p>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="data-visualization.html#cb264-1" tabindex="-1"></a>tbl_new <span class="ot">&lt;-</span> tbl_mz <span class="sc">%&gt;%</span></span>
<span id="cb264-2"><a href="data-visualization.html#cb264-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">&#39;positive&#39;</span>, <span class="st">&#39;negative&#39;</span>), n_peaks, <span class="at">replace =</span> <span class="cn">TRUE</span>))</span>
<span id="cb264-3"><a href="data-visualization.html#cb264-3" tabindex="-1"></a></span>
<span id="cb264-4"><a href="data-visualization.html#cb264-4" tabindex="-1"></a>w <span class="ot">&lt;-</span> <span class="fu">which</span>(tbl_new<span class="sc">$</span>class <span class="sc">==</span> <span class="st">&#39;C&#39;</span> <span class="sc">&amp;</span> tbl_new<span class="sc">$</span>group <span class="sc">==</span> <span class="st">&#39;negative&#39;</span>)</span>
<span id="cb264-5"><a href="data-visualization.html#cb264-5" tabindex="-1"></a></span>
<span id="cb264-6"><a href="data-visualization.html#cb264-6" tabindex="-1"></a>p23 <span class="ot">&lt;-</span> tbl_new[<span class="sc">-</span>w, ] <span class="sc">%&gt;%</span> </span>
<span id="cb264-7"><a href="data-visualization.html#cb264-7" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(int)) <span class="sc">+</span> </span>
<span id="cb264-8"><a href="data-visualization.html#cb264-8" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb264-9"><a href="data-visualization.html#cb264-9" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>()</span>
<span id="cb264-10"><a href="data-visualization.html#cb264-10" tabindex="-1"></a></span>
<span id="cb264-11"><a href="data-visualization.html#cb264-11" tabindex="-1"></a>p24 <span class="ot">&lt;-</span> p23 <span class="sc">+</span> <span class="fu">facet_wrap</span>(group <span class="sc">~</span> class)</span>
<span id="cb264-12"><a href="data-visualization.html#cb264-12" tabindex="-1"></a>p25 <span class="ot">&lt;-</span> p23 <span class="sc">+</span> <span class="fu">facet_grid</span>(group <span class="sc">~</span> class)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-215-1.png" width="768" style="display: block; margin: auto;" /></p>
</div>
</div>
</div>
<div id="labels" class="section level4 unnumbered hasAnchor">
<h4>Labels<a href="data-visualization.html#labels" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Adding text to plots to enhance the visualization is an important aspect of data analysis. Labels help to identify the variables being plotted and provide context for the audience.</p>
<p>When adding labels to a plot, it is important to consider the type of plot being used and the information being displayed. For example, in a scatter plot, labels can be added to each point to indicate the value of each variable. In a line chart, labels can be added to the x and y axes to indicate the units of measurement.</p>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb265-1"><a href="data-visualization.html#cb265-1" tabindex="-1"></a>p26 <span class="ot">&lt;-</span> tbl_mz <span class="sc">%&gt;%</span> </span>
<span id="cb265-2"><a href="data-visualization.html#cb265-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(mz, int)) <span class="sc">+</span> </span>
<span id="cb265-3"><a href="data-visualization.html#cb265-3" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">xend =</span> mz, <span class="at">yend =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb265-4"><a href="data-visualization.html#cb265-4" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> tbl_mz <span class="sc">%&gt;%</span> <span class="fu">slice_max</span>(int, <span class="at">n =</span> <span class="dv">10</span>),</span>
<span id="cb265-5"><a href="data-visualization.html#cb265-5" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">label =</span> mz),</span>
<span id="cb265-6"><a href="data-visualization.html#cb265-6" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="dv">0</span>)</span>
<span id="cb265-7"><a href="data-visualization.html#cb265-7" tabindex="-1"></a></span>
<span id="cb265-8"><a href="data-visualization.html#cb265-8" tabindex="-1"></a>p27 <span class="ot">&lt;-</span> tbl_mz <span class="sc">%&gt;%</span> </span>
<span id="cb265-9"><a href="data-visualization.html#cb265-9" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(mz, int)) <span class="sc">+</span> </span>
<span id="cb265-10"><a href="data-visualization.html#cb265-10" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">xend =</span> mz, <span class="at">yend =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb265-11"><a href="data-visualization.html#cb265-11" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> tbl_mz <span class="sc">%&gt;%</span> <span class="fu">slice_max</span>(int, <span class="at">n =</span> <span class="dv">10</span>),</span>
<span id="cb265-12"><a href="data-visualization.html#cb265-12" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">label =</span> mz),</span>
<span id="cb265-13"><a href="data-visualization.html#cb265-13" tabindex="-1"></a>             <span class="at">vjust =</span> <span class="dv">0</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-217-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>A handy package not in the tidyverse, is <code>ggrepel</code>, which allows for the labels to rearrange themselves such that none of them overlap.</p>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="data-visualization.html#cb266-1" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb266-2"><a href="data-visualization.html#cb266-2" tabindex="-1"></a></span>
<span id="cb266-3"><a href="data-visualization.html#cb266-3" tabindex="-1"></a>p28 <span class="ot">&lt;-</span> tbl_mz <span class="sc">%&gt;%</span> </span>
<span id="cb266-4"><a href="data-visualization.html#cb266-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(mz, int)) <span class="sc">+</span> </span>
<span id="cb266-5"><a href="data-visualization.html#cb266-5" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">xend =</span> mz, <span class="at">yend =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb266-6"><a href="data-visualization.html#cb266-6" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="at">data =</span> tbl_mz <span class="sc">%&gt;%</span> <span class="fu">slice_max</span>(int, <span class="at">n =</span> <span class="dv">10</span>),</span>
<span id="cb266-7"><a href="data-visualization.html#cb266-7" tabindex="-1"></a>                  <span class="fu">aes</span>(<span class="at">label =</span> mz), </span>
<span id="cb266-8"><a href="data-visualization.html#cb266-8" tabindex="-1"></a>                  <span class="at">box.padding =</span> .<span class="dv">5</span>, <span class="at">color =</span> <span class="st">&#39;dodgerblue&#39;</span>)</span>
<span id="cb266-9"><a href="data-visualization.html#cb266-9" tabindex="-1"></a></span>
<span id="cb266-10"><a href="data-visualization.html#cb266-10" tabindex="-1"></a>p29 <span class="ot">&lt;-</span> tbl_mz <span class="sc">%&gt;%</span> </span>
<span id="cb266-11"><a href="data-visualization.html#cb266-11" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(mz, int)) <span class="sc">+</span> </span>
<span id="cb266-12"><a href="data-visualization.html#cb266-12" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">xend =</span> mz, <span class="at">yend =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb266-13"><a href="data-visualization.html#cb266-13" tabindex="-1"></a>  <span class="fu">geom_label_repel</span>(<span class="at">data =</span> tbl_mz <span class="sc">%&gt;%</span> <span class="fu">slice_max</span>(int, <span class="at">n =</span> <span class="dv">10</span>),</span>
<span id="cb266-14"><a href="data-visualization.html#cb266-14" tabindex="-1"></a>                   <span class="fu">aes</span>(<span class="at">label =</span> mz), </span>
<span id="cb266-15"><a href="data-visualization.html#cb266-15" tabindex="-1"></a>                   <span class="at">box.padding =</span> .<span class="dv">5</span>, <span class="at">color =</span> <span class="st">&#39;dodgerblue&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-219-1.png" width="768" style="display: block; margin: auto;" /></p>
</div>
<div id="annotations" class="section level4 unnumbered hasAnchor">
<h4>Annotations<a href="data-visualization.html#annotations" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Annotations add explanatory text or labels to a plot, providing additional information to the reader. Adding annotations to a plot can help convey the message behind the data and make the plot more understandable.</p>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="data-visualization.html#cb267-1" tabindex="-1"></a>p30 <span class="ot">&lt;-</span> p12 <span class="sc">+</span> </span>
<span id="cb267-2"><a href="data-visualization.html#cb267-2" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">x =</span> <span class="cn">Inf</span>,  <span class="at">y =</span> <span class="cn">Inf</span>,  <span class="at">label =</span> <span class="st">&#39;Top-Right&#39;</span>,    <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb267-3"><a href="data-visualization.html#cb267-3" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="sc">-</span><span class="cn">Inf</span>, <span class="at">y =</span> <span class="cn">Inf</span>,  <span class="at">label =</span> <span class="st">&quot;Top-left&quot;</span>,     <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">vjust =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb267-4"><a href="data-visualization.html#cb267-4" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>, <span class="at">x =</span> <span class="cn">Inf</span>,  <span class="at">y =</span> <span class="sc">-</span><span class="cn">Inf</span>, <span class="at">label =</span> <span class="st">&#39;Bottom-Right&#39;</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb267-5"><a href="data-visualization.html#cb267-5" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="sc">-</span><span class="cn">Inf</span>, <span class="at">y =</span> <span class="sc">-</span><span class="cn">Inf</span>, <span class="at">label =</span> <span class="st">&quot;Bottom-left&quot;</span>,  <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-221-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="style" class="section level4 unnumbered hasAnchor">
<h4>Style<a href="data-visualization.html#style" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Creating a plotting style can help you to quickly improve the appearance of your plots and make them more consistent with your brand. When working with data visualization, it’s important to keep in mind that the appearance of your plots can significantly impact the way your audience interprets your data. GGplot2 themes and colors offer an easy way to create professional-looking visualizations that will make your data stand out.</p>
<div id="themes" class="section level5 unnumbered hasAnchor">
<h5>Themes<a href="data-visualization.html#themes" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>To apply a theme to your plot, you simply need to call the <code>theme()</code> function and specify the name of the theme you want to use. Some of the most popular themes include:</p>
<ul>
<li><code>theme_gray()</code>: A simple, gray background with white gridlines.</li>
<li><code>theme_dark()</code>: A simple, gray background with white gridlines.</li>
<li><code>theme_classic()</code>: A classic black and white theme with no gridlines.</li>
<li><code>theme_minimal()</code>: A minimalistic theme with no background or gridlines.</li>
<li><code>theme_bw()</code>: A black and white theme with gray gridlines.</li>
</ul>
<p>You can also create your own custom themes by modifying various theme elements. For example, you can change the background color, font, and size of the plot elements. To do this, you can use the <code>element_*()</code> functions. For example, the <code>element_text()</code> function allows you to modify the font size, color, and family of your text.</p>
<p>Another great feature of GGplot2 themes is that they allow you to maintain consistency across multiple visualizations. If you’re creating a series of plots, applying the same theme to each one will give your work a more polished and professional look.</p>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="data-visualization.html#cb268-1" tabindex="-1"></a>p31 <span class="ot">&lt;-</span> p12 <span class="sc">+</span> <span class="fu">theme_gray</span>() <span class="co"># default</span></span>
<span id="cb268-2"><a href="data-visualization.html#cb268-2" tabindex="-1"></a>p32 <span class="ot">&lt;-</span> p12 <span class="sc">+</span> <span class="fu">theme_dark</span>()</span>
<span id="cb268-3"><a href="data-visualization.html#cb268-3" tabindex="-1"></a>p33 <span class="ot">&lt;-</span> p12 <span class="sc">+</span> <span class="fu">theme_light</span>()</span>
<span id="cb268-4"><a href="data-visualization.html#cb268-4" tabindex="-1"></a>p34 <span class="ot">&lt;-</span> p12 <span class="sc">+</span> <span class="fu">theme_classic</span>()</span>
<span id="cb268-5"><a href="data-visualization.html#cb268-5" tabindex="-1"></a>p35 <span class="ot">&lt;-</span> p12 <span class="sc">+</span> <span class="fu">theme_minimal</span>()</span>
<span id="cb268-6"><a href="data-visualization.html#cb268-6" tabindex="-1"></a>p36 <span class="ot">&lt;-</span> p12 <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-224-1.png" width="768" style="display: block; margin: auto;" /></p>
</div>
<div id="colors-1" class="section level5 unnumbered hasAnchor">
<h5>Colors<a href="data-visualization.html#colors-1" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>In addition to applying a theme to your layout, you can should also consider the color scheme. GGplot2 is a powerful data visualization package in R that allows users to create beautiful and informative graphs. The package is highly customizable, and one of its most important features is the ability to customize colors using Brewer and manual color scales.</p>
<div id="brewer-color-scales" class="section level6 unnumbered hasAnchor">
<h6>Brewer Color Scales<a href="data-visualization.html#brewer-color-scales" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<p>The Brewer color scales in GGplot2 are color palettes that have been specifically designed to be distinguishable by people with color vision deficiencies. These color scales are useful when creating visualizations where color is used to convey information.</p>
<p>The Brewer palettes are particularly useful because they are carefully curated to ensure that the colors are distinguishable from one another, even for individuals with color vision deficiencies. This makes them a great option for creating informative data visualizations.</p>
<p>To use Brewer color scales in GGplot2, you can simply specify the name of the color scale as an argument to the <code>scale_color_brewer()</code> or <code>scale_fill_brewer()</code> functions. Other popular Brewer color scales include Blues, Greens, Oranges, and Purples. By using these scales, you can create beautiful visualizations that are both aesthetically pleasing and informative.</p>
</div>
<div id="manual-color-scales" class="section level6 unnumbered hasAnchor">
<h6>Manual Color Scales<a href="data-visualization.html#manual-color-scales" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<p>In addition to the Brewer color scales, GGplot2 also allows users to specify custom color scales using the <code>scale_color_manual()</code> or <code>scale_fill_manual()</code> functions. These functions take a vector of colors as an argument, which can be specified using names, hex codes, or RGB values.</p>
<p>Manual color scales are particularly useful when you want to use specific colors that are not included in the Brewer palettes. For example, if you are creating a visualization for a company and you want to use the company’s brand colors, you can specify the colors using a manual color scale.</p>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="data-visualization.html#cb269-1" tabindex="-1"></a>p37 <span class="ot">&lt;-</span> p31</span>
<span id="cb269-2"><a href="data-visualization.html#cb269-2" tabindex="-1"></a>p38 <span class="ot">&lt;-</span> p31 <span class="sc">+</span> <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&#39;Set1&#39;</span>)</span>
<span id="cb269-3"><a href="data-visualization.html#cb269-3" tabindex="-1"></a>p39 <span class="ot">&lt;-</span> p31 <span class="sc">+</span> <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&#39;Blues&#39;</span>)</span>
<span id="cb269-4"><a href="data-visualization.html#cb269-4" tabindex="-1"></a>p40 <span class="ot">&lt;-</span> p31 <span class="sc">+</span> <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#d97828&quot;</span>, <span class="st">&quot;#83992a&quot;</span>, <span class="st">&quot;#995d81&quot;</span>,<span class="st">&quot;#44709d&quot;</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-227-1.png" width="672" style="display: block; margin: auto;" /></p>

</div>
</div>
</div>
</div>
</div>
<div id="alternatives-1" class="section level2 hasAnchor" number="8.3">
<h2><span class="header-section-number">8.3</span> Alternatives<a href="data-visualization.html#alternatives-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="lattice" class="section level3 hasAnchor" number="8.3.1">
<h3><span class="header-section-number">8.3.1</span> lattice<a href="data-visualization.html#lattice" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The Lattice package is an R package that is used for plotting graphs, and is based on the grid graphics system. The package provides a high-level interface to grid graphics, which makes it easy to create complex visualizations with an emphasis on multivariate data. It is designed to meet most typical graphics needs with minimal tuning, but can also be easily extended to handle most nonstandard requirements.</p>
<p>Trellis Graphics, originally developed for S and S-PLUS at the Bell Labs, is a framework for data visualization developed by <em>R. A. Becker, W. S. Cleveland, et al, extending ideas presented in Cleveland’s 1993 book Visualizing Data</em>. The Lattice API is based on the original design in S, but extends it in many ways.</p>
<p>Various types of lattice plots available for data visualization. Among the different types of plots, <strong>univariate</strong> plots stand out as they utilize only a single variable for plotting. The different options available for univariate plots include bar plots, box-and-whisker plots, kernel density estimates, dot plots, histograms, quantile plots, and one-dimensional scatter plots. <strong>Bivariate</strong> plots involve plotting two variables against each other. Examples of bivariate plots include scatterplots and quantile plots. These types of plots are useful in analyzing the relationship between two variables and can provide valuable insights into the data. <strong>Trivariate</strong> plots, as the name implies, involve plotting three variables and provide a more complex visualization of the data. Options for trivariate plots include level plots, contour plots, three-dimensional scatter plots, and three-dimensional surface plots. These types of plots can be particularly helpful in analyzing complex data sets and identifying patterns in the data that may not be immediately apparent.</p>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="data-visualization.html#cb270-1" tabindex="-1"></a><span class="fu">library</span>(lattice)</span>
<span id="cb270-2"><a href="data-visualization.html#cb270-2" tabindex="-1"></a></span>
<span id="cb270-3"><a href="data-visualization.html#cb270-3" tabindex="-1"></a>p51 <span class="ot">&lt;-</span> <span class="fu">xyplot</span>(int <span class="sc">~</span> mz, <span class="at">data =</span> tbl_mz, <span class="at">main =</span> <span class="st">&quot;Scatter Plot&quot;</span>)</span>
<span id="cb270-4"><a href="data-visualization.html#cb270-4" tabindex="-1"></a>p52 <span class="ot">&lt;-</span> <span class="fu">xyplot</span>(int <span class="sc">~</span> mz, <span class="at">data =</span> tbl_mz, <span class="at">type=</span><span class="st">&#39;a&#39;</span>, <span class="at">main =</span> <span class="st">&quot;Line Plot&quot;</span>)</span>
<span id="cb270-5"><a href="data-visualization.html#cb270-5" tabindex="-1"></a>p53 <span class="ot">&lt;-</span> <span class="fu">histogram</span>(<span class="sc">~</span> <span class="fu">log10</span>(int) <span class="sc">|</span> class, <span class="at">data =</span> tbl_mz, <span class="at">main =</span> <span class="st">&quot;Histogram&quot;</span>)</span>
<span id="cb270-6"><a href="data-visualization.html#cb270-6" tabindex="-1"></a>p54 <span class="ot">&lt;-</span> <span class="fu">densityplot</span>(<span class="sc">~</span> <span class="fu">log10</span>(int) <span class="sc">|</span> class, <span class="at">data =</span> tbl_mz, <span class="at">main =</span> <span class="st">&quot;Density Plot&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-229-1.png" width="768" style="display: block; margin: auto;" /></p>
</div>
<div id="plotly" class="section level3 hasAnchor" number="8.3.2">
<h3><span class="header-section-number">8.3.2</span> plotly<a href="data-visualization.html#plotly" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Plotly is an open-source data visualization library that allows you to create interactive visualizations in R <a href="https://plotly.com/r/">plotly.com/r/</a>. It offers a wide range of graphs and charts, including line plots, scatter plots, area charts, bar charts, error bars, box plots, histograms, heatmaps, subplots, plots with multiple-axes, 3D plots, and more. The package is built on top of <strong>htmlwidgets</strong>, which means that you can easily embed your visualizations in web applications or other HTML documents.</p>
<p>Plotly also nativity supports many data science languages such as R, Python, Julia, Java-script, MATLAB and F#.</p>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb271-1"><a href="data-visualization.html#cb271-1" tabindex="-1"></a><span class="fu">library</span>(plotly)</span></code></pre></div>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb272-1"><a href="data-visualization.html#cb272-1" tabindex="-1"></a><span class="fu">plot_ly</span>(tbl_mz, <span class="at">x =</span> <span class="sc">~</span>mz, <span class="at">y =</span> <span class="sc">~</span>int, <span class="at">color =</span> <span class="sc">~</span>class,</span>
<span id="cb272-2"><a href="data-visualization.html#cb272-2" tabindex="-1"></a>        <span class="at">mode =</span> <span class="st">&quot;markers&quot;</span>, <span class="at">type =</span> <span class="st">&quot;scatter&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb272-3"><a href="data-visualization.html#cb272-3" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">title =</span> <span class="st">&#39;Scatter Plot&#39;</span>)</span></code></pre></div>
<div id="htmlwidget-2f16bc2fb829f2b29825" style="width:576px;height:288px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-2f16bc2fb829f2b29825">{"x":{"visdat":{"15054526ac060":["function () ","plotlyVisDat"]},"cur_data":"15054526ac060","attrs":{"15054526ac060":{"x":{},"y":{},"mode":"markers","color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Scatter Plot","xaxis":{"domain":[0,1],"automargin":true,"title":"mz"},"yaxis":{"domain":[0,1],"automargin":true,"title":"int"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[1563.8,533.2,444.9,973.5,798.9,1220.3,1374.7,950.5,1746,1171.8,837.9,1513.2,954.4,1569.9,1815.4,977,1645.8,1082,841.6,1483,1990.8,918.1,1826.2,1293.8,1378.2,1328.8,1559.4,1828.3,1358.5,678.7,1164,1097.9,969.7,1287.7,1406.8,1092.8,1621.6,1277.2,1934.3,1120.6,1830.1,925.5,1490.6,1392.8,510.1,866.2,378.6,647.3,1630.3,708.5,381.6,1883.3,724.5,1266,1187.4,403.8,1283.4,519.8,1969.1,1766.9,1496.1,1973.8,885.1,1463.9,456.2,1203.4,1853.7,818.1,1048.6,484.1,1392.7,1668.3],"y":[316.339396962678,43.0531555651166,230.99620712256,4753.74570800894,546.490360530442,0.641619733112295,4755.91653217067,281.583326557862,28.4230329492369,6.35795150217342,553.234632701204,42.7936673891039,291.490778644971,312.980263336391,1621.37962145664,11.3421566459644,123.887798819855,931.931609706924,28.3234157326495,5609.01197963556,38.637769252121,450.859090550323,433.337257705479,112.100725462424,135.693468149475,312.630478034618,70.2859432345316,2446.76203024958,2.09946169083369,149.430537017848,33.9128436209187,43.1563024294809,1637.76461173659,23.2080195447907,61.2771841711284,133.914944356224,1022.6700854748,7.26866554122981,33.8838185180388,379.020330064831,93.8173023421443,143.357638511232,1100.57249948277,368.394999580626,7250.75644622702,321.318076372201,76.6950750294759,10.6777944983854,2834.07295528223,157.642585009362,2379.54508428927,83.8691771690965,4225.7296712429,344.915947775921,125.421813492888,246.632681588529,29.606178892953,347.062128979212,197.155664031152,25.5629355653273,1519.79612669244,2200.00237102161,374.744596459451,931.89826023156,54.9214256381572,73.4921855740536,2652.98907223067,1535.9760206651,0.47756516069906,79.2835197295574,10392.6419241972,90.2801886104816],"mode":"markers","type":"scatter","name":"A","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"line":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1662.1,1035.8,1735,554.1,676.3,784.3,1640.3,1162.4,1381.1,1579,451.3,1596.3,466.4,1015.9,1239.4,877.3,1636.2,616.9,1734.4,1088.9,1454.8,1689.5,456,891.1,898.2,1520.3,487,541.2,1491.9,747.7,1625.3,1231.8,1494.2,506.8,1501.4,925.7,1911.6,1892.5,1569.3,836.2,610.8,860.8,1403.8,1600.1,1845.9,1703.2,1456.2,1932.1,606.4,833.8,504.2,522.3,1855.9,840.9,1920,1061,611.1,1801.8,1895.6,1608.6,810.3,1586,847.5,1025.2,901.6,431.3,1008.5,484.5,432.3,1286.5,1806.6,1489.3,630.5,564.6,1691.8,412.6,1786,1500,1349.5,1658.3,1257.6,1963,1616.7],"y":[976.064921042087,33.049033678444,117.893258916082,9542.01384389176,96.8812641977475,1642.97964481095,124.36251908233,180.443493855115,1370.92045939429,34.6316110558086,547.962239053928,8.83927327541216,2394.7608093764,85.6474474055958,203.99609468263,549.060809737898,342.22634138713,186.540488082018,71.8235005028725,369.107004614656,73.7052492506094,3635.1937267304,1577.94311221125,14.4656372607548,110.81402934164,49.045876783738,138.86450856578,4386.9340139696,41.2530931129694,402.990689579754,5232.70042935952,478.008429930017,1029.6059589632,147.920476783523,42.4140574929503,4827.23450191855,38.5397517606116,5201.45769901999,874.426024889437,127.359536270707,1212.64398844618,239.750751443866,104.832608011848,1581.35427573318,3390.47567580813,718.390696520016,31.4918626103281,47.523160578095,295.899616432911,268.138872762834,559.578509356414,211.840716863322,117.314533237309,2316.2552428255,693.557284386504,8.46453638182125,17.8591096885793,16.1923414764331,155.944137557006,1967.80032870898,317.007379986964,18.3222073243497,180.781643773931,567.71900488417,980.467022333278,83.422580095408,92.8540277756817,3.47392263319739,4103.78648805606,40.8009597732513,15.9763548469531,35.5576452914921,452.504790323448,30.4808952621382,72.0863012709346,45.4657717612983,1862.47566290523,25.382559579646,221.552604415902,267.936594264764,60.8702756915095,59.2306301453417,282.712415982258],"mode":"markers","type":"scatter","name":"B","marker":{"color":"rgba(252,141,98,1)","line":{"color":"rgba(252,141,98,1)"}},"textfont":{"color":"rgba(252,141,98,1)"},"error_y":{"color":"rgba(252,141,98,1)"},"error_x":{"color":"rgba(252,141,98,1)"},"line":{"color":"rgba(252,141,98,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1667.6,1073.8,709.9,1796.3,1829.2,1267.3,1280,991.2,1891.3,569.3,1243.9,1774.3,498.9,605.7,1661.5,678,1025.9,1187.9,626.5,1512.4,1979.7,1816.9,434.6,665.8,627.5,954.6,500.7,1197.2,1069.3,463.6,929.2,1685.1,964.5,1097.2,1053.2,1716.8,469.3,829.6,1247.2,1524.1,1996.1,1437,1296.9,1681.2,864.4,987.7,1993.5,693.7,615.7,536.2,477.3,976.2,1121,758,1907.5,444.5,1851.1,1678.8,766.7,841.7,1402,907.4,1126.4,1145.1,990.8,1500.4,1164.3,1395.1,1441,1227.9,1062.2,844.8,1117.8,615.3,1985.1,644.5,1674.1,1809.5],"y":[421.366586558392,6.75771917932137,3466.59557543799,96.3105907486478,59.6071453677775,7.81858460072623,4.64092148690518,10906.457974418,595.827429104972,435.911485227864,206.804572085087,89.6653850606128,76.2739968459335,27.0180102726262,277.801205907089,1706.26422889263,1991.07208351096,338.640798418567,61.7564446565989,267.813279096122,244.955161852097,3851.73791640546,1200.85916374048,1634.00059455884,240.984107511011,47.7154324976051,4774.54392097972,227.713304207172,1226.88281253093,573.60681691792,7.75499186354404,10.2938332433096,1929.92686823944,123.343933726038,26.6851746138733,106.41572545138,18481.7985050108,31.5698940954731,2.99087287511884,99.8548120363577,24.3383007198782,230.422590545695,295.802920065314,6.15818436984155,301.123391362927,297.591310410638,11.4631670531544,83.759083164092,228.561843793045,15.8930049005228,27.2914051239238,332.620148851459,3.37282444658354,3.91799002859779,2.17823757528943,14.5154850442091,339.905903810708,2.92394900003927,185.571726643359,318.829892876569,1124.76820404783,1131.60961922328,212.455660125331,586.567468795123,944.240762654834,251.300297514615,114.011995162097,1928.91797588438,68.3092110252193,71.3168653630974,277.606553023986,1126.80215081712,406.87548280187,70.7438038186037,85.7796020986858,1325.55029599816,529.67186048474,31.1466636541553],"mode":"markers","type":"scatter","name":"C","marker":{"color":"rgba(141,160,203,1)","line":{"color":"rgba(141,160,203,1)"}},"textfont":{"color":"rgba(141,160,203,1)"},"error_y":{"color":"rgba(141,160,203,1)"},"error_x":{"color":"rgba(141,160,203,1)"},"line":{"color":"rgba(141,160,203,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[737.7,1673,739,1488.6,1733.8,1080.6,1886.3,1796.5,477.9,386.2,1298.3,1401.1,1601.1,1325.7,1914.7,1807.8,511.6,1466.2,1903.6,713.9,1370.2,743,451.1,912.9,839.7,389.6,1187.6,537.9,1277,767.4,879.6,1203,506.6,1281.8,1229.6,593.9,1648.6,400.9,1276.7,1937,947.8,1220.7,1202.4,613.3,1642.8,1045.2,1892.9,503.2,1663.5,1272.2,379.4,699.2,1232.9,1396.7,890.3,755.7,1699.2,399.5,931.3,1406.4,1394.5,355,798,1474.8,903.1,1200.4,1477.3],"y":[1.13028183101442,4.85706914945726,536.911839357284,104.951628635971,0.669370888093889,12.3035589742534,8.58261109861717,170.398073758107,85.2177869436686,962.879847809714,115.757061199178,7891.69053971304,71.6170982128315,31.5854422885556,450.746655522678,2521.14311830679,84.110739841344,30.0727298925422,39.7832897799757,523.602230874283,609.159649527182,1417.31250472318,293.574087473547,25.4392943417999,101.34393184493,3.85320420326774,192.628837922946,371.62142286096,2.40541966111138,43.5794701536177,1837.59359264228,224.506406990801,28810.0690424921,123.208073033961,332.004267359919,163.722955141596,1000.77791592206,31.8455316728577,244.649019135026,125.280626009335,4.37244146925518,1922.55851622189,10.8230708922186,24.2330910834176,659.26208869622,92.9680735719791,297.040248172482,327.953745925116,3.24517997881949,148.099870520004,315.815971752864,28.5305241990304,53.8414400241618,764.585784350655,324.323587086717,61.9007725203961,836.558329041907,7.42431797285982,128.773704748324,1583.29499207549,117.917255965473,1337.10502039953,234.577167502372,2488.62024394622,14.2644349556145,7.16143774684378,33260.5844777559],"mode":"markers","type":"scatter","name":"D","marker":{"color":"rgba(231,138,195,1)","line":{"color":"rgba(231,138,195,1)"}},"textfont":{"color":"rgba(231,138,195,1)"},"error_y":{"color":"rgba(231,138,195,1)"},"error_x":{"color":"rgba(231,138,195,1)"},"line":{"color":"rgba(231,138,195,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>

</div>
</div>
<div id="exercises-5" class="section level2 unnumbered hasAnchor">
<h2>Exercises<a href="data-visualization.html#exercises-5" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<table>
<colgroup>
<col width="30%" />
<col width="69%" />
</colgroup>
<tbody>
<tr class="odd">
<td><img src="images/07.png" height="68" /></td>
<td><ul>
<li><p>Create a new R Studio Project and name it <strong>006_data_visualizing</strong>.</p></li>
<li><p>Create a new R script, add your name and date at the top as comments.</p></li>
<li><p>Locate and/or download a GGplot2 cheat-sheet and refer to it as needed.</p></li>
</ul></td>
</tr>
</tbody>
</table>
<ol style="list-style-type: decimal">
<li>If not already done, download <em>Bacterial Metabolite Data (tidy)</em> to use as an example data file.</li>
</ol>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb273-1"><a href="data-visualization.html#cb273-1" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">&quot;https://raw.githubusercontent.com/jeffsocal/ASMS_R_Basics/main/data/bacterial-metabolites_dose-simicillin_tidy.csv&quot;</span></span>
<span id="cb273-2"><a href="data-visualization.html#cb273-2" tabindex="-1"></a><span class="fu">download.file</span>(url, <span class="at">destfile =</span> <span class="st">&quot;./data/bacterial-metabolites_dose-simicillin_tidy.csv&quot;</span>)</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li><p>Read in the dataset .csv using the <code>tidyverse</code> set of packages.</p></li>
<li><p>Create a plot of metabolite <code>Abundance</code> by <code>Time_min</code> …
<img src="_main_files/figure-html/unnamed-chunk-234-1.png" width="384" style="display: block; margin: auto;" /></p></li>
<li><p>… facet by <code>Organism</code> and <code>Metabolite</code>…
<img src="_main_files/figure-html/unnamed-chunk-235-1.png" width="576" style="display: block; margin: auto;" /></p></li>
<li><p>… adjust the y-axis to log10, color by <code>Dose_mg</code>, and add a 50% transparent line …
<img src="_main_files/figure-html/unnamed-chunk-236-1.png" width="768" style="display: block; margin: auto;" /></p></li>
<li><p>… change the theme to something publishable, add a title, modify the x- and y-axis label, modify the legend title, adjust the y-axis ticks to show the actually measured time values, and pick a color scheme that highlights the dose value…
<img src="_main_files/figure-html/unnamed-chunk-237-1.png" width="768" style="display: block; margin: auto;" /></p></li>
</ol>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-wrangling.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="sharing.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jeffsocal/asms_r_intro/edit/BRANCH/08_01-visualization.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": [["ASMS_R_Basics.zip", "HTML"]],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
