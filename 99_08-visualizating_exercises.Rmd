## **9** Data Visualization {-}

```{r, eval=FALSE}
# John Doe
# 2023-06-02
# Institution Inc.
#
# Data Visualization Exercises

# 1. If not already done, download *Denver Climate Data* to use as an example data file.

url <- "https://raw.githubusercontent.com/ZenBrayn/asms-2022-r-shortcourse/main/exercises/intro_to_r/data/denver_climate.csv"
download.file(url, destfile = "./data/denver_climate.csv")


# 2. Read in the dataset .csv using the `tidyverse` set of packages.

tbl_den <- "./data/denver_climate.csv" %>% read_csv()


# 3. Plot precipitation ~ snowfall ...

tbl_den %>% 
  ggplot(aes(precipitation, snowfall)) + 
  geom_point()


# 4. ... color by `min_temp`, creating a color scheme of low = "lightblue" and 
#    high = "orange", mid = "yellow"...

tbl_den %>% 
  ggplot(aes(precipitation, snowfall)) + 
  geom_point(aes(color = min_temp)) +
  scale_color_gradientn(colors = c('lightblue','yellow', 'orange'))


# 5. ... add a smoothed line under the points colored grey, facet by `year` 
#    keeping all plots on a single line, and change the theme to have a dark 
#    background ...

tbl_den %>% 
  ggplot(aes(precipitation, snowfall)) + 
  geom_smooth(method = lm, color = 'grey', fill = NA) +
  geom_point(aes(color = min_temp)) +
  scale_color_gradientn(colors = c('lightblue','yellow', 'orange')) +
  facet_wrap(~year, nrow = 1) +
  coord_cartesian(ylim = c(0, 20)) +
  theme_dark()


# 6. Using the same data, construct a plot showing the distribution of min_ and 
#    max_temp for each month such that min_ and max_ are plotted separately for 
#    each month, add point values on top, gradient colored as above. Substitute 
#    the month number for the month 3-letter string (hint, use lubridate), remove 
#    the legend, remove the grid lines, remove the x-axis labels, add a title and 
#    fix the y-axis title. Use the internet to find answers if you need to.

library(glue)

tbl_den %>%
  mutate(month = lubridate::month(month, label = TRUE, abbr = TRUE)) %>%
  pivot_longer(cols = c('min_temp', 'max_temp'), names_to = 'temp_ends', values_to = 'temp') %>%
  ggplot() +
  geom_boxplot(aes(month, temp, group = temp_ends), fill=NA, color='grey40', position = 'identity') +
  geom_point(aes(month, temp, group = temp_ends, color = temp)) +
  facet_wrap(~month, nrow = 1, scales = 'free_x') +
  scale_color_gradientn(colors = c('lightblue','yellow', 'orange')) +
  labs(title = "Monthly Temperatures for Denver",
       subtitle = glue("{min(tbl_den$year)} - {max(tbl_den$year)}"),
       y = "Temperature (C)") +
  theme_classic() +
  theme(
    legend.position = 'none',
    axis.text.x = element_blank(),
    axis.title.x = element_blank(),
    axis.ticks.x = element_blank()
  )
```